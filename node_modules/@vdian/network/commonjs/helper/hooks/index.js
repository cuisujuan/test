"use strict";
Object.defineProperty(exports, "__esModule", { value: true });
var util = require("../../util");
/**
 * @ignore
 * Hooks类，用于在请求过程中插入钩子函数，方便开发者介入到请求各个过程中。
 */
var Hooks = /** @class */ (function () {
    function Hooks() {
        this.hooks = {};
    }
    /**
     * push方法，该方法作用为插入指定钩子函数。
     * @param name hook名称
     * @param fn hook hook回调函数
     * @returns Hooks实例
     */
    Hooks.prototype.push = function (name, fn) {
        var fns = this.hooks[name] || (this.hooks[name] = []);
        if (typeof fn === 'function') {
            fns.push(fn);
        }
        return this;
    };
    Hooks.prototype.unshift = function (name, fn) {
        var fns = this.hooks[name] || (this.hooks[name] = []);
        if (typeof fn === 'function') {
            fns.unshift(fn);
        }
        return this;
    };
    Hooks.prototype.invokeWaterfall = function (name, args, callback) {
        var fns = this.hooks[name];
        if (!fns || !fns.length) {
            callback();
            return this;
        }
        var i = 0;
        function next(error) {
            if (util.isError(error)) {
                return callback(error);
            }
            i++;
            if (i >= fns.length) {
                return callback();
            }
            fns[i](args, next);
        }
        fns[i](args, next);
        return this;
    };
    return Hooks;
}());
exports.default = Hooks;
