import { isObject, goto } from '../../../util';
import { GLOBAL } from '../../../constants';
import { setQuerystring } from '@vdian/url';
import { toast } from '../util';
// 实名认证处理
var IDENTITY_CODES = 20;
var IDENTITY_REDIRECT_KEY = 'redirect';
var IDENTITY_TIMEOUT = 1000;
/**
 * @ignore
 * false：中断后续代码执行，true：不中断执行
 * @param data 传入的响应数据
 * @returns boolean
 */
export function identity(data) {
    var _a;
    if (isObject(data)) {
        var status_1 = isObject(data.status) ? data.status : {};
        var result = isObject(data.result) ? data.result : {};
        var url_1 = result.authPageUrl;
        // 如果符合实名认证条件
        if (status_1.code == IDENTITY_CODES && url_1) {
            // 追加当前页面redirect参数
            url_1 = setQuerystring(url_1, (_a = {},
                _a[IDENTITY_REDIRECT_KEY] = GLOBAL.location.href,
                _a));
            result.message && toast(result.message);
            setTimeout(function () {
                goto(url_1);
            }, IDENTITY_TIMEOUT);
            return false;
        }
    }
    return true;
}
