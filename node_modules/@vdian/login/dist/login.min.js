!function(){function n(n){var e=n===nn.DEV||n===nn.DAILY?"-daily.test":n===nn.PRE?"-pre.test":"",t=n===nn.DEV||n===nn.DAILY?".daily":n===nn.PRE?".pre":"";return{backendHost:"https://sso"+e+".weidian.com",loginPageHost:"https://h5"+t+".weidian.com",ssoPageHost:"https://"+(n===nn.DEV||n===nn.DAILY?"wd.daily":n===nn.PRE?"wd.pre":"sso")+".weidian.com",thorHost:"https://thor"+t+".weidian.com"}}function e(){var n,e=V.location.hostname;switch(n=(n=e.match(/(?=.)\bdev\b|\bdaily\b|\bpre\b(?=.)/))?n[0]:null){case"dev":return nn.DEV;case"daily":return nn.DAILY;case"pre":return nn.PRE;default:return nn.PROD}}function t(t){return n(void 0===t?e():Number(t))}function o(){return V.location.href}function r(){return V.navigator.userAgent}function i(n){return n.split(".").slice(-2).join(".")}function s(n){return void 0===n||n}function u(n){n=n||location.hostname;var e=["koudai.com","91ruyu.com","bibikan.cn","fangxin.com","xihuan.com.cn","youshop01.com","youshop02.com","youshop03.com","youshop04.com","youshop05.com","youshop06.com","youshop07.com","youshop08.com","youshop09.com","youshop10.com","kou6ai.cn","ynet.com","mitao.cn"],t=!1;return e.forEach(function(e){!t&&n.indexOf(e)>-1&&(t=e)}),t}function c(n,e){var r,s,c,n=n||o();switch(e){case Z:u()&&!k()&&(r=t(),s=r.backendHost+"/user/synclogin",c=u(),n=s+"?type="+c+"&redirect="+encodeURIComponent(n));break;case $:u()&&(r=t(),s=r.backendHost+"/user/synclogout",c=i(location.hostname),n=s+"?type="+c+"&redirect="+encodeURIComponent(n))}return e!==$&&H()&&k()&&x(S(),"5.5.2.1")<0&&(n=encodeURIComponent(n)),n}function a(n){var e;return(e=new RegExp("(?:^|; )"+n+"=([^;]*)").exec(W.cookie))?e[1]:null}function d(n){var e=[];for(var t in n)"object"==typeof n[t]?e.push(t+"="+JSON.stringify(n[t])):e.push(encodeURIComponent(t)+"="+encodeURIComponent(n[t]));return e.join("&")}function l(){return{status:{code:"",message:"",description:""},result:{}}}function f(n,e,t){var o=l();if(n&&n.status){var r,i,s=n.status,u=s.status_code,c=s.message;switch(u){case 0:r=J,i=K;break;case 420010:r=F,i=z;break;default:r=u,i=c}o.status.code=r,o.status.message=i,o.result=n.result,u===J?e&&e(o):t&&t(o)}else t&&t(new Error("interface isn't legal"))}function h(n){return void 0!==n}function p(n,e,t){var o="";return o=n+e,h(t)&&(o+="?"+d(t)),o}function m(n){var e,n=n||{},t=n.data||{},o=n.jsonp||"callback",r=n.success,i=n.error,s=n.url;if(!s)return i&&i(new Error("url is not defined!"));var u="jsonp_"+Y++,c=document.getElementsByTagName("head")[0],a=document.createElement("script");t[o]=u;var l=function(){var n=!1;return function(){n||(n=!0,e?r&&r(e):i&&i(new Error("callback function error!")))}}();a.onreadystatechange=function(){"complete"!==this.readyState&&"loaded"!==this.readyState||l()},a.onload=l,a.onerror=function(n){c.removeChild(a),window[u]=null,i&&i(n)},window[u]=function(n){c.removeChild(a),window[u]=null,e=n},a.src=s+(-1==s.indexOf("?")?"?":"&")+d(t),c.appendChild(a)}function g(){return!!(a(q)||a(B)||a(G))}function v(){return!(!g()||!a(G))}function b(){return!(!g()||"LOGIN_USER_SOURCE_WECHAT"!==a(M))}function w(){return!(!g()||"LOGIN_USER_SOURCE_QQ"!==a(M))}function y(){return!(!g()||"SUB_ACCOUNT"!==a(T))}function E(){return/MicroMessenger/i.test(r())&&!I()}function R(){return/QQ\/([\d\.]+)/i.test(r())}function I(){return/wxwork/i.test(r())}function k(){return/WDBuyer/i.test(r())}function H(){return/android/i.test(r())}function S(){var n,e=r(),t=/WDAPP\((.*?)\/(.*?)[\s|\)]/i,o=e.match(t);return o&&3==o.length&&(o[1],n=o[2]),n}function x(n,e){if(n===e)return 0;for(var t=n.split("."),o=e.split("."),r=Math.min(t.length,o.length),i=0;i<r;i++){if(parseInt(t[i])>parseInt(o[i]))return 1;if(parseInt(t[i])<parseInt(o[i]))return-1}return t.length>o.length?1:t.length<o.length?-1:0}function L(n){var n=n||{},e=n.success,o=n.error,r=t(n.environment),i=r.thorHost+"/wdshop/shop.base.getShopExistInfo/1.0",s=a(G);if(!s)return o&&o(new Error("没获取到当前登录的卖家id"));m({url:i,data:{context:{shop_id:s}},success:function(n){e&&e(n)},error:function(n){o&&o(n)}})}function O(n){var n=n||{},e=n.success,o=n.error;m({url:t(n.environment).backendHost+"/user/oauth/bind/getdemand",success:function(n){f(n,function(n){e&&e(n)},function(n){o&&o(n)})},error:function(n){o&&o(n)}})}function P(n){var e,n=n||{},o=n.success,r=n.error,e=t(n.environment),i=e.backendHost+"/user/getinfo",s=l();g()?m({url:i,success:function(n){f(n,function(n){o&&o(n)},function(n){r&&r(n)})},error:function(n){r&&r(n)}}):(s.status.code=F,s.status.message=z,s.result="",r&&r(s))}function _(n){var n=n||{},e=c(n.url,Z),o=t(n.environment),r=n.device;return p(o.backendHost,"/user/oauth/qq/login",{redirect:e,type:s(r)?"mobile":"pc"})}function C(n){var n=n||{},e=c(n.url,Z);return p(t(n.environment).backendHost,"/user/oauth/wechat/silentlogin",{redirect:e})}function D(n){var n=n||{},e=c(n.url,Z);return p(t(n.environment).backendHost,"/user/oauth/wechat/login",{redirect:e})}function U(n){var n=n||{},e=t(n.environment),o=encodeURIComponent(c(n.url,Z));return[s(n.device)?e.ssoPageHost+"/login/index.php":e.loginPageHost+"/m/signin/index.html","?redirect="+o,h(n.oauth)?"&oauth=0":"",h(n.force)?"&force=1":"",h(n.bind)?"&bind=1":"",h(n.nochoice)?"&nochoice=1":"",h(n.seller)?"&seller=1":"",h(n.sellerswitchshop)?"&sellerswitchshop="+n.sellerswitchshop:""].join("")}function A(n){var n=n||{},e=c(n.url,Z);return[t(n.environment).ssoPageHost+"/login/index.php","?redirect="+e,"&register=1"].join("")}function N(n){var n=n||{},e=c(n.url,$);return p(t(n.environment).backendHost,"/user/logout",{redirect:e})}function j(n){var n=n||{},e=c(n.url,X);return p(t(n.environment).ssoPageHost,"/login/index.php",{redirect:e,bind:1})}function Q(n){var n=n||{},e=n.success,o=n.error,r=n.param,i=t(n.environment),s=i.thorHost+"/wdshop/shop.base.mutiAddShop/1.0";if(!a(G))return o&&o(new Error("没获取到当前登录的卖家id"));var u={shopName:"我的小店",shopLogo:"https://si.geilicdn.com/img-390300000174535cb4ed0a21924a-unadjust_62_62.png"};r=r||u,m({url:s,data:{param:JSON.stringify(r)},success:function(n){e&&e(n)},error:function(n){o&&o(n)}})}var V=window,W=document,Y=0,q="is_login",B="uid",G="sid",M="login_source",T="login_type",J=0,F=2,K="OK",z="LOGIN ERROR",X=0,Z=1,$=2,nn={DEV:0,DAILY:1,PRE:2,PROD:3},U={isLogin:g,isSellerLogin:v,isWechatLogin:b,isQQLogin:w,isSubAccount:y,getUserInfo:P,qqLogin:_,wechatSlientLogin:C,wechatForceLogin:D,login:U,register:A,logout:N,bind:j,getBindStatus:O,isWeixin:E,isQQ:R,isOpenShop:L,addShop:Q};"undefined"!=typeof module&&module.exports?module.exports=U:V.login=U}();