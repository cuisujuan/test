# API

URL库通过初始化Url class得到url组成的各个属性，提供Url、setQuerystring、getQuerystring三个API。

## Url

传入链接地址，得到Url实例，通过解析地址，得到多个与url相关的属性与方法。

### 参数

Url 类参数。

| 名称 | 类型   | 默认值 | 是否必填 | 描述                                                      |
| ---- | ------ | ------ | -------- | --------------------------------------------------------- |
| url  | String |        | 是       | 链接地址。如果为相对地址，则会以当前页面url作为base url。 |

### 返回值

返回Url 实例，实例包括以下属性与方法。

#### 属性

##### href

返回 url href 值，也可修改url href 值。

```
const url = new Url('https://www.weidian.com/')
// get url href
let href = url.href
// set url href
url.href = 'https://www.koudai.com/a.html'
console.log(url.host) // www.koudai.com
```

##### host、hostname、pathname、port、protocol、hash、search

与href保持一致。

#####  origin

origin 为只读属性，不可修改值。

#####  query

query 为参数对象，可修改或者追加参数，为了更好的兼容与容错，与URLSearchParams稍有不同，参数value序列化规则如下：

1. 对于 null/undefined，参数设置无效。
2. 对于空字符串，参数设置为空字符串。
3. 对于数组，参数设置为name=array[0]&name=array[1]……。
4. 其他类型均调用 encodeURIComponent 进行序列化。

```
const url = new Url('https://www.weidian.com/index.html?a=1&a=2&b=3')
// get query 
const query = url.query // {a:['1','2'],b:3}
// set query
query.c = 4
console.log(url.href) // https://www.weidian.com/index.html?a=1&a=2&b=3&c=4
```

#### 方法

#####  toString

该方法与 url.href 一致。

```
const url = new Url('https://www.weidian.com/index.html?a=1&a=2&b=3')
console.log(url.href === url.toString()) // true
```

## getQuerystring

获取传入url地址的参数对象。

### 参数

方法参数。

| 名称 | 类型   | 默认值               | 是否必填 | 描述                                                         |
| ---- | ------ | -------------------- | -------- | ------------------------------------------------------------ |
| url  | String | window.location.href |          | 链接地址。如果url为null/undefined，则以当前页面url作为默认值。如果url为相对地址，不进行url 规整化处理。 |

### 返回值

返回query 对象，与 url.query 规则一致。

## setQuerystring

设置url的querystring。

### 参数

该方法包含三个参数。

| 名称    | 类型   | 默认值                      | 是否必填 | 描述                                                         |
| ------- | ------ | --------------------------- | -------- | ------------------------------------------------------------ |
| url     | String | window.location.href        |          | 链接地址。如果url为null/undefined，则以当前页面url作为默认值。 |
| params  | Object |                             | 是       | 需设置的参数对象。                                           |
| options | Object | {<br />replace: true<br />} |          | 设置参数合并规则，具体见参数合并规则。                       |

参数合并规则

1. 如果replace=true，则将替换url中相同的参数，避免出现name=1&name=2这类情况。
2. 如果replace=false，则直接将params追加到当前url后。

### 示例

```
// replace = true
const url = setQuerystring('https://www.weidian.com/index.html?a=2',{ a:1 })
console.log(url.href) // https://www.weidian.com/index.html?a=1

// replace = false
const url = setQuerystring('https://www.weidian.com/index.html?a=2',{ a:1 })
console.log(url.href) // https://www.weidian.com/index.html?a=2&a=1
```

